
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../quick-start/">
      
      
        <link rel="next" href="../indexing-querying/">
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.8">
    
    
      
        <title>Getting Started - Hollow (Netflix OSS)</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Robot:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Robot";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="brown">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#getting-started" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Hollow (Netflix OSS)" class="md-header__button md-logo" aria-label="Hollow (Netflix OSS)" data-md-component="logo">
      
  <img src="../img/logo_white_bg.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Hollow (Netflix OSS)
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Getting Started
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="red" data-md-color-accent="brown"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="brown"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Netflix/hollow" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Hollow (Netflix OSS)" class="md-nav__button md-logo" aria-label="Hollow (Netflix OSS)" data-md-component="logo">
      
  <img src="../img/logo_white_bg.png" alt="logo">

    </a>
    Hollow (Netflix OSS)
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Netflix/hollow" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quick-start/" class="md-nav__link">
        Quick Start
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Getting Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Getting Started
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    Core Concepts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-a-data-snapshot" class="md-nav__link">
    Producing a Data Snapshot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consumer-api-generation" class="md-nav__link">
    Consumer API Generation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consuming-a-data-snapshot" class="md-nav__link">
    Consuming a Data Snapshot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-a-delta" class="md-nav__link">
    Producing a Delta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consuming-a-delta" class="md-nav__link">
    Consuming a Delta
  </a>
  
    <nav class="md-nav" aria-label="Consuming a Delta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#incremental-production" class="md-nav__link">
    Incremental Production
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexing-data-for-retrieval" class="md-nav__link">
    Indexing Data for Retrieval
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hierarchical-data-models" class="md-nav__link">
    Hierarchical Data Models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restoring-at-startup" class="md-nav__link">
    Restoring at Startup
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../indexing-querying/" class="md-nav__link">
        Indexing/Querying
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../infrastructure/" class="md-nav__link">
        Infrastructure Hooks
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../producer-consumer-apis/" class="md-nav__link">
        Producers and Consumers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tooling/" class="md-nav__link">
        Tooling
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../data-modeling/" class="md-nav__link">
        Data Modeling
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../diving-deeper/" class="md-nav__link">
        Diving Deeper
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../interacting-with-a-dataset/" class="md-nav__link">
        Interacting with a Hollow Dataset
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../data-ingestion/" class="md-nav__link">
        Data Ingestion
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../validation/" class="md-nav__link">
        Validation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../advanced-topics/" class="md-nav__link">
        Advanced Topics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../testing/" class="md-nav__link">
        Testing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../community/" class="md-nav__link">
        Community
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../acknowledgements/" class="md-nav__link">
        Acknowledgements
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../license/" class="md-nav__link">
        License
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    Core Concepts
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-a-data-snapshot" class="md-nav__link">
    Producing a Data Snapshot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consumer-api-generation" class="md-nav__link">
    Consumer API Generation
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consuming-a-data-snapshot" class="md-nav__link">
    Consuming a Data Snapshot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#producing-a-delta" class="md-nav__link">
    Producing a Delta
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#consuming-a-delta" class="md-nav__link">
    Consuming a Delta
  </a>
  
    <nav class="md-nav" aria-label="Consuming a Delta">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#incremental-production" class="md-nav__link">
    Incremental Production
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#indexing-data-for-retrieval" class="md-nav__link">
    Indexing Data for Retrieval
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#hierarchical-data-models" class="md-nav__link">
    Hierarchical Data Models
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restoring-at-startup" class="md-nav__link">
    Restoring at Startup
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="getting-started">Getting Started<a class="headerlink" href="#getting-started" title="Permanent link">&para;</a></h1>
<p>In the <a href="../quick-start/">Quick Start</a> guide, we got a reference implementation of Hollow up and running, with a mock data 
model that can be easily modified to suit any use case.  After reading this section, you'll have an understanding of the 
basic usage patterns for Hollow, and how each of the core pieces fit together.</p>
<h2 id="core-concepts">Core Concepts<a class="headerlink" href="#core-concepts" title="Permanent link">&para;</a></h2>
<p>Hollow manages datasets which are built by a single <em>producer</em>, and disseminated to one or many <em>consumers</em> for 
read-only access.  A dataset changes over time.  The timeline for a changing dataset can be broken down into discrete 
<em>data states</em>, each of which is a complete snapshot of the data at a particular point in time.</p>
<h2 id="producing-a-data-snapshot">Producing a Data Snapshot<a class="headerlink" href="#producing-a-data-snapshot" title="Permanent link">&para;</a></h2>
<p>Let's assume we have a POJO class <code>Movie</code>:
<div class="language-java highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nd">@HollowPrimaryKey</span><span class="p">(</span><span class="n">fields</span><span class="o">=</span><span class="s">&quot;id&quot;</span><span class="p">)</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Movie</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">releaseYear</span><span class="p">;</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Movie</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">releaseYear</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">releaseYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">releaseYear</span><span class="p">;</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>And that many <code>Movie</code>s exist which comprise a dataset that needs to be disseminated:
<div class="language-java highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Movie</span><span class="o">&gt;</span><span class="w"> </span><span class="n">movies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;The Matrix&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1999</span><span class="p">),</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Beasts of No Nation&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="p">),</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Pulp Fiction&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1994</span><span class="p">)</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="p">);</span>
</span></code></pre></div></p>
<p>We'll need a data <em>producer</em> to create a data state which will be transmitted to consumers:
<div class="language-java highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">File</span><span class="w"> </span><span class="n">localPublishDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s">&quot;/path/to/local/disk/publish/dir&quot;</span><span class="p">);</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="n">HollowFilesystemPublisher</span><span class="w"> </span><span class="n">publisher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HollowFilesystemPublisher</span><span class="p">(</span><span class="n">localPublishDir</span><span class="p">);</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="n">HollowFilesystemAnnouncer</span><span class="w"> </span><span class="n">announcer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HollowFilesystemAnnouncer</span><span class="p">(</span><span class="n">localPublishDir</span><span class="p">);</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="n">HollowProducer</span><span class="w"> </span><span class="n">producer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HollowProducer</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">        </span><span class="p">.</span><span class="na">withPublisher</span><span class="p">(</span><span class="n">publisher</span><span class="p">)</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">        </span><span class="p">.</span><span class="na">withAnnouncer</span><span class="p">(</span><span class="n">announcer</span><span class="p">)</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="w">        </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="n">producer</span><span class="p">.</span><span class="na">runCycle</span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">Movie</span><span class="w"> </span><span class="n">movie</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">movies</span><span class="p">)</span>
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">movie</span><span class="p">);</span>
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="p">});</span>
</span></code></pre></div></p>
<p>This producer runs a single <em>cycle</em> and produces a data state.  Once this runs, you should have a <em>snapshot</em> blob file 
on your local disk.  </p>
<div class="admonition note">
<p class="admonition-title">Publishing Blobs</p>
<p>Note that the example code above is writing data to local disk.  This is a great way to start testing.  In a 
production scenario, data can be written to a remote file store such as Amazon S3 for retrieval by consumers.  See 
the <a href="https://github.com/Netflix/hollow-reference-implementation">reference implementation</a> and the 
<a href="../quick-start/">quick start guide</a> for a scalable example using AWS.</p>
</div>
<h2 id="consumer-api-generation">Consumer API Generation<a class="headerlink" href="#consumer-api-generation" title="Permanent link">&para;</a></h2>
<p>Once the data has been populated into a producer, that producer's <em>state engine</em> is aware of the data model, and can be 
used to automatically produce a client API.  We can also initialize the data model from a brand new <em>state engine</em> using 
our POJOs:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">HollowWriteStateEngine</span><span class="w"> </span><span class="n">writeEngine</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HollowWriteStateEngine</span><span class="p">();</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">HollowObjectMapper</span><span class="w"> </span><span class="n">mapper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HollowObjectMapper</span><span class="p">(</span><span class="n">writeEngine</span><span class="p">);</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">mapper</span><span class="p">.</span><span class="na">initializeTypeState</span><span class="p">(</span><span class="n">Movie</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">HollowAPIGenerator</span><span class="w"> </span><span class="n">generator</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">       </span><span class="k">new</span><span class="w"> </span><span class="n">HollowAPIGenerator</span><span class="p">.</span><span class="na">Builder</span><span class="p">().</span><span class="na">withAPIClassname</span><span class="p">(</span><span class="s">&quot;MovieAPI&quot;</span><span class="p">)</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="w">                                       </span><span class="p">.</span><span class="na">withPackageName</span><span class="p">(</span><span class="s">&quot;how.hollow.example&quot;</span><span class="p">)</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="w">                                       </span><span class="p">.</span><span class="na">withDataModel</span><span class="p">(</span><span class="n">writeEngine</span><span class="p">)</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="w">                                       </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="n">generator</span><span class="p">.</span><span class="na">generateFiles</span><span class="p">(</span><span class="s">&quot;/path/to/java/api/files&quot;</span><span class="p">);</span>
</span></code></pre></div>
<p>After this code executes, a set of Java files will be written to the location <code>/path/to/java/api/files</code>.  These java 
files will be a generated API based on the data model defined by the schemas in our state engine, and will provide 
convenient methods to access that data.</p>
<div class="admonition hint">
<p class="admonition-title">Initializing multiple types</p>
<p>If we have multiple top-level types, we should call <code>initializeTypeState()</code> multiple times, once for each class.</p>
</div>
<h2 id="consuming-a-data-snapshot">Consuming a Data Snapshot<a class="headerlink" href="#consuming-a-data-snapshot" title="Permanent link">&para;</a></h2>
<p>A data consumer can load a snapshot created by the producer into memory:
<div class="language-java highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">File</span><span class="w"> </span><span class="n">localPublishDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s">&quot;/path/to/local/disk/publish/dir&quot;</span><span class="p">);</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="n">HollowFilesystemBlobRetriever</span><span class="w"> </span><span class="n">blobRetriever</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">                                </span><span class="k">new</span><span class="w"> </span><span class="n">HollowFilesystemBlobRetriever</span><span class="p">(</span><span class="n">localPublishDir</span><span class="p">);</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="n">HollowFilesystemAnnouncementWatcher</span><span class="w"> </span><span class="n">announcementWatcher</span><span class="w"> </span><span class="o">=</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">                                </span><span class="k">new</span><span class="w"> </span><span class="n">HollowFilesystemAnnouncementWatcher</span><span class="p">(</span><span class="n">localPublishDir</span><span class="p">);</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="n">HollowConsumer</span><span class="w"> </span><span class="n">consumer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HollowConsumer</span><span class="p">.</span><span class="na">withBlobRetriever</span><span class="p">(</span><span class="n">blobRetriever</span><span class="p">)</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="w">                                        </span><span class="p">.</span><span class="na">withAnnouncementWatcher</span><span class="p">(</span><span class="n">announcementWatcher</span><span class="p">)</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">                                        </span><span class="p">.</span><span class="na">withGeneratedAPIClass</span><span class="p">(</span><span class="n">MovieAPI</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">                                        </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="n">consumer</span><span class="p">.</span><span class="na">triggerRefresh</span><span class="p">();</span>
</span></code></pre></div></p>
<p>The <code>HollowConsumer</code> will retrieve data using the provided <code>BlobRetrievier</code>, and will load the latest <em>data state</em> 
currently announced by the <code>AnnouncementWatcher</code>.</p>
<p>Once this dataset is loaded into memory, we can access the data for any records using our generated API.  Below, we're 
iterating over all records:
<div class="language-java highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">MovieAPI</span><span class="w"> </span><span class="n">movieApi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">MovieAPI</span><span class="p">)</span><span class="n">consumer</span><span class="p">.</span><span class="na">getAPI</span><span class="p">();</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="k">for</span><span class="p">(</span><span class="n">MovieHollow</span><span class="w"> </span><span class="n">movie</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">movieApi</span><span class="p">.</span><span class="na">getAllMovieHollow</span><span class="p">())</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">movie</span><span class="p">.</span><span class="na">getId</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">                       </span><span class="n">movie</span><span class="p">.</span><span class="na">getTitle</span><span class="p">().</span><span class="na">getValue</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="w"> </span><span class="o">+</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">                       </span><span class="n">movie</span><span class="p">.</span><span class="na">getReleaseYear</span><span class="p">());</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>The output of the above code will be:
<div class="language-text highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>1, The Matrix, 1999
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>2, Beasts of No Nation, 2015
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>3, Pulp Fiction, 1994
</span></code></pre></div></p>
<div class="admonition note">
<p class="admonition-title">Integrating with Infrastructure</p>
<p>In order to integrate with your infrastructure, you only need to provide Hollow with four implementations of simple 
interfaces:</p>
<ul>
<li>The <code>HollowProducer</code> needs a <code>Publisher</code> and <code>Announcer</code></li>
<li>The <code>HollowConsumer</code> needs a <code>BlobRetriever</code> and <code>AnnouncementWatcher</code></li>
</ul>
<p>Your <code>BlobRetriever</code> and <code>AnnouncementWatcher</code> implementations should be mirror your <code>Publisher</code> and <code>Announcer</code> 
interfaces.   Here, we're publishing and retrieving from local disk.  In production, we'll be publishing to and 
retrieving from a remote file store.  We'll discuss in more detail how to integrate with your specific 
infrastructure in <a href="../infrastructure/#infrastructure-integration">Infrastructure Integration</a>.</p>
</div>
<h2 id="producing-a-delta">Producing a Delta<a class="headerlink" href="#producing-a-delta" title="Permanent link">&para;</a></h2>
<p>Some time has passed and the dataset has evolved.  It now contains these records:
<div class="language-java highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Movie</span><span class="o">&gt;</span><span class="w"> </span><span class="n">movies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;The Matrix&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1999</span><span class="p">),</span>
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Beasts of No Nation&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2015</span><span class="p">),</span>
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Goodfellas&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1990</span><span class="p">),</span>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Inception&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2010</span><span class="p">)</span>
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="p">);</span>
</span></code></pre></div></p>
<p>The producer, needs to communicate this updated dataset to consumers.  We're going to create a brand new state, and the 
entirety of the data for the new state must be added to the state engine in a new <em>cycle</em>.   When the cycle runs, a new 
data state will be <em>published</em>, and the new data state's (automatically generated) version identifier will be 
<em>announced</em>.</p>
<p>Using the same <code>HollowProducer</code> in memory, we can use the following code:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">producer</span><span class="p">.</span><span class="na">runCycle</span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">Movie</span><span class="w"> </span><span class="n">movie</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">movies</span><span class="p">)</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">movie</span><span class="p">);</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="p">});</span>
</span></code></pre></div>
<p>Let's take a closer look at what the above code does.  The same <code>HollowProducer</code> which was used to produce the 
<em>snapshot</em> blob is used -- it already knows everything about the prior state and can be transitioned to the next state.<br />
When creating a new state, <strong>all of the movies currently in our dataset are re-added again.</strong>  It's not necessary to 
figure out which records were added, removed, or modified -- that's Hollow's job.</p>
<p>Each time we call <code>runCycle</code> we will be producing a <em>data state</em>.  For each state after the first, the <code>HollowProducer</code> 
will publish three artifacts: a <em>snapshot</em>, a <em>delta</em>, and a <em>reverse delta</em>.  Encoded into the <em>delta</em> is a set of 
instructions to update a consumer’s data store from the previous state to the current state.  Inversely, encoded into 
each <em>reverse delta</em> is a set of instructions to update a consumer in reverse -- from the current state to the previous 
state.  Consumers may use the <em>reverse delta</em> later if we need to <a href="../infrastructure/#pinning-consumers">pin</a>.</p>
<p>When consumers initialize, they will use the most recent <em>snapshot</em> to initialize their data store.  After 
initialization, consumers will keep up to date using <em>deltas</em>.</p>
<div class="admonition note">
<p class="admonition-title">Producer Cycles</p>
<p>We call what the producer does to create a data state a <em>cycle</em>.  During each <em>cycle</em>, you’ll want to add 
<em>every record</em> from your source of truth.  Hollow will handle the details of publishing a delta for all of your 
established consumer instances, and a snapshot to initialize any consumer instances which start up before your next 
cycle.</p>
</div>
<h2 id="consuming-a-delta">Consuming a Delta<a class="headerlink" href="#consuming-a-delta" title="Permanent link">&para;</a></h2>
<p>No manual intervention is necessary to consume the delta you produced.  The <code>HollowConsumer</code> will automatically stay 
up-to-date.  </p>
<div class="admonition hint">
<p class="admonition-title">Announcements keep consumers updated</p>
<p>When the producer runs a cycle, it <em>announces</em> the latest version.  The <code>AnnouncementWatcher</code> implementation 
provided to the <code>HollowConsumer</code> will listen for changes to the announced version -- and when updates occur notify 
the <code>HollowConsumer</code> by calling <code>triggerAsyncRefresh()</code>.  See the source of the 
<code>HollowFilesystemAnnouncementWatcher</code>, or the 
<a href="https://github.com/Netflix/hollow-reference-implementation/blob/master/src/main/java/how/hollow/consumer/infrastructure/S3AnnouncementWatcher.java">two</a> 
separate <a href="https://github.com/Netflix/hollow-reference-implementation/blob/master/src/main/java/how/hollow/consumer/infrastructure/DynamoDBAnnouncementWatcher.java">examples</a> 
in the reference implementation.</p>
</div>
<p>After this delta has been applied, the consumer is at the new state.  If the generated API is used to iterate over the 
movies again as shown in the prior consumer example, the new output will be:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>1, The Matrix, 1999
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>2, Beasts of No Nation, 2015
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>4, Goodfellas, 1990
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>5, Inception, 2010
</span></code></pre></div>
<div class="admonition hint">
<p class="admonition-title">Thread Safety</p>
<p>It is safe to use Hollow to retrieve data while a delta transition is in progress.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Adjacent States</p>
<p>We refer to states which are directly connected via single delta transitions as <em>adjacent</em> states, and a continuous 
set of adjacent states as a <em>delta chain</em></p>
</div>
<h3 id="incremental-production">Incremental Production<a class="headerlink" href="#incremental-production" title="Permanent link">&para;</a></h3>
<p>If it is known what changes are applied to a dataset then incremental production may be utilized.  This can be
more efficient than providing the whole dataset on each cycle.  An incremental producer is built in a similar manner
to a producer:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="n">File</span><span class="w"> </span><span class="n">localPublishDir</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s">&quot;/path/to/local/disk/publish/dir&quot;</span><span class="p">);</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="n">HollowFilesystemPublisher</span><span class="w"> </span><span class="n">publisher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HollowFilesystemPublisher</span><span class="p">(</span><span class="n">localPublishDir</span><span class="p">);</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">HollowFilesystemAnnouncer</span><span class="w"> </span><span class="n">announcer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HollowFilesystemAnnouncer</span><span class="p">(</span><span class="n">localPublishDir</span><span class="p">);</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="n">HollowProducer</span><span class="p">.</span><span class="na">Incremental</span><span class="w"> </span><span class="n">incProducer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HollowProducer</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">        </span><span class="p">.</span><span class="na">withPublisher</span><span class="p">(</span><span class="n">publisher</span><span class="p">)</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">        </span><span class="p">.</span><span class="na">withAnnouncer</span><span class="p">(</span><span class="n">announcer</span><span class="p">)</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">        </span><span class="p">.</span><span class="na">buildIncremental</span><span class="p">();</span>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="n">incProducer</span><span class="p">.</span><span class="na">runIncrementalCycle</span><span class="p">(</span><span class="n">istate</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">Movie</span><span class="w"> </span><span class="n">movie</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">modifiedMovies</span><span class="p">)</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="na">addOrModify</span><span class="p">(</span><span class="n">movie</span><span class="p">);</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">Movie</span><span class="w"> </span><span class="n">movie</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">deletedMovies</span><span class="p">)</span>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="na">delete</span><span class="p">(</span><span class="n">movie</span><span class="p">);</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="p">});</span>
</span></code></pre></div>
<p>This incremental producer runs a cycle for the changes to set of movies (those which are new, have changed, or have been 
removed).  Other than that an incremental producer behaves the same as a producer and a consumer will not know the
difference.</p>
<div class="admonition note">
<p class="admonition-title">Adjacent States</p>
<p>Any record added, modified or removed must have a primary key, since this determines the
record's identity</p>
</div>
<h2 id="indexing-data-for-retrieval">Indexing Data for Retrieval<a class="headerlink" href="#indexing-data-for-retrieval" title="Permanent link">&para;</a></h2>
<p>In prior examples the generated Hollow API was used by the data consumer to iterate over all <code>Movie</code> records in the 
dataset.  Most often, however, it isn’t desirable to iterate over the entire dataset — instead, specific records will be 
accessed based on some known key.  The <code>Movie</code>’s id is a known key (since it is annotated with <code>@HollowPrimaryKey</code>).</p>
<p>After a <code>HollowConsumer</code> has been initialized, any type can be indexed.  For example, we can index <code>Movie</code> records by 
<code>id</code>:
<div class="language-java highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="n">HollowConsumer</span><span class="w"> </span><span class="n">consumer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...;</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">consumer</span><span class="p">.</span><span class="na">triggerRefresh</span><span class="p">();</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="n">UniqueKeyIndex</span><span class="o">&lt;</span><span class="n">Movie</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Movie</span><span class="p">.</span><span class="na">uniqueIndex</span><span class="p">(</span><span class="n">consumer</span><span class="p">);</span>
</span></code></pre></div></p>
<p>This index can be held in memory and then used in conjunction with the generated Hollow API to retrieve Movie records by 
id:
<div class="language-text highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>Movie movie = idx.findMatch(2);
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>if(movie != null)
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>    System.out.println(&quot;Found Movie: &quot; + movie.getTitle().getValue());
</span></code></pre></div></p>
<p>Which outputs:
<div class="language-text highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>Found Movie: Beasts of No Nation
</span></code></pre></div></p>
<p>In our generated API, each type annotated with <code>@HollowPrimaryLey</code> has a static method to obtain a <code>UniqueIndex</code>.  For
primary keys with multiple fields a <em>bean</em> class is also generated to hold key values.</p>
<p>A <code>UniqueIndex</code> may be also created explicitly to index by any field, or multiple fields.</p>
<div class="admonition hint">
<p class="admonition-title">Reuse Indexes</p>
<p>Retrieval from an index is extremely cheap, and indexing is (relatively) expensive.  You should create your indexes 
when the <code>HollowConsumer</code> is initialized and share them thereafter.  Indexes will automatically stay up-to-date with 
the <code>HollowConsumer</code>.</p>
</div>
<div class="admonition hint">
<p class="admonition-title">Thread Safety</p>
<p>Retrievals from Hollow indexes are thread-safe.  They are safe to use across multiple threads, and it is safe to 
query while a transition is in progress.</p>
</div>
<p>We've just begun to scratch the surface of what indexes can do.  See <a href="../indexing-querying/">Indexing/Querying</a> for an 
in-depth exploration of this topic.</p>
<h2 id="hierarchical-data-models">Hierarchical Data Models<a class="headerlink" href="#hierarchical-data-models" title="Permanent link">&para;</a></h2>
<p>Our data models can be much richer than in the prior example.  Assume an updated <code>Movie</code> class:
<div class="language-java highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Movie</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">releaseYear</span><span class="p">;</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">    </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Actor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">actors</span><span class="p">;</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Movie</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">title</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">year</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Actor</span><span class="o">&gt;</span><span class="w"> </span><span class="n">actors</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">;</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">title</span><span class="p">;</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">releaseYear</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">year</span><span class="p">;</span>
</span><span id="__span-14-11"><a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">actors</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actors</span><span class="p">;</span>
</span><span id="__span-14-12"><a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-14-13"><a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>Which references <code>Actor</code> records:
<div class="language-java highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nd">@HollowPrimaryKey</span><span class="p">(</span><span class="n">field</span><span class="o">=</span><span class="s">&quot;actorId&quot;</span><span class="p">)</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Actor</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">    </span><span class="kt">long</span><span class="w"> </span><span class="n">actorId</span><span class="p">;</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">actorName</span><span class="p">;</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="nf">Actor</span><span class="p">(</span><span class="kt">long</span><span class="w"> </span><span class="n">actorId</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">actorName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">actorId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actorId</span><span class="p">;</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="na">actorName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actorName</span><span class="p">;</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>Some records are added to a <code>HollowProducer</code>:
<div class="language-java highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="n">List</span><span class="o">&lt;</span><span class="n">Movie</span><span class="o">&gt;</span><span class="w"> </span><span class="n">movies</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;The Matrix&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1999</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">Actor</span><span class="p">(</span><span class="mi">101</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Keanu Reeves&quot;</span><span class="p">),</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">Actor</span><span class="p">(</span><span class="mi">102</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Laurence Fishburne&quot;</span><span class="p">),</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">Actor</span><span class="p">(</span><span class="mi">103</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Carrie-Ann Moss&quot;</span><span class="p">),</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">Actor</span><span class="p">(</span><span class="mi">104</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Hugo Weaving&quot;</span><span class="p">)</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">        </span><span class="p">)),</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Movie</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Event Horizon&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1997</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span>
</span><span id="__span-16-9"><a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">Actor</span><span class="p">(</span><span class="mi">102</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Laurence Fishburne&quot;</span><span class="p">),</span>
</span><span id="__span-16-10"><a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="w">                </span><span class="k">new</span><span class="w"> </span><span class="n">Actor</span><span class="p">(</span><span class="mi">105</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Sam Neill&quot;</span><span class="p">)</span>
</span><span id="__span-16-11"><a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a><span class="w">        </span><span class="p">))</span>
</span><span id="__span-16-12"><a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="p">);</span>
</span><span id="__span-16-13"><a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a>
</span><span id="__span-16-14"><a id="__codelineno-16-14" name="__codelineno-16-14" href="#__codelineno-16-14"></a><span class="n">producer</span><span class="p">.</span><span class="na">runCycle</span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-15"><a id="__codelineno-16-15" name="__codelineno-16-15" href="#__codelineno-16-15"></a><span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">Movie</span><span class="w"> </span><span class="n">movie</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">movies</span><span class="p">)</span>
</span><span id="__span-16-16"><a id="__codelineno-16-16" name="__codelineno-16-16" href="#__codelineno-16-16"></a><span class="w">        </span><span class="n">state</span><span class="p">.</span><span class="na">addObject</span><span class="p">(</span><span class="n">movie</span><span class="p">);</span>
</span><span id="__span-16-17"><a id="__codelineno-16-17" name="__codelineno-16-17" href="#__codelineno-16-17"></a><span class="p">});</span>
</span></code></pre></div></p>
<p>When we add these movies to the dataset, Hollow will traverse everything referenced by the provided records and add them 
to the state as well.  Consequently, both a type <code>Movie</code> and a type <code>Actor</code> will exist in the data model after the above 
code runs.  </p>
<div class="admonition hint">
<p class="admonition-title">Deduplication</p>
<p>Laurence Fishburne starred in both of these films.  Rather than creating two <code>Actor</code> records for Mr. Fishburne, 
a single record will be created and assigned to both of our <code>Movie</code> records.  This <em>deduplication</em> happens 
automatically by virtue of having the exact same data contained in both Actor inputs.</p>
</div>
<p>Consumers of this dataset may want to also create an index for <code>Actor</code> records.  For example:
<div class="language-java highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="n">UniqueKeyIndex</span><span class="o">&lt;</span><span class="n">Actor</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Actor</span><span class="p">.</span><span class="na">uniqueIndex</span><span class="p">(</span><span class="n">consumer</span><span class="p">);</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="n">Actor</span><span class="w"> </span><span class="n">actor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">actorIdx</span><span class="p">.</span><span class="na">findMatch</span><span class="p">(</span><span class="mi">102</span><span class="p">);</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="k">if</span><span class="p">(</span><span class="n">actor</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Found Actor: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">actor</span><span class="p">.</span><span class="na">getActorName</span><span class="p">().</span><span class="na">getValue</span><span class="p">());</span>
</span></code></pre></div></p>
<p>Outputs:
<div class="language-text highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>Found Actor: Laurence Fishburne
</span></code></pre></div></p>
<h2 id="restoring-at-startup">Restoring at Startup<a class="headerlink" href="#restoring-at-startup" title="Permanent link">&para;</a></h2>
<p>From time to time, we need to redeploy our producer.  When we first create a <code>HollowProducer</code> and run a cycle it will 
not be able to produce a delta, because it does not know anything about the prior <em>data state</em>.  If no action is taken, 
a new state with only a snapshot will be produced and announced, and clients will load that data state with an operation 
called a <a href="../advanced-topics/#double-snapshot">double snapshot</a>, which has potentially undesirable performance 
characteristics.  </p>
<p>We can remedy this situation by <em>restoring</em> our newly created producer with the last announced data state.  For example:</p>
<div class="language-java highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="n">Publisher</span><span class="w"> </span><span class="n">publisher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="n">Announcer</span><span class="w"> </span><span class="n">announcer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="n">BlobRetriever</span><span class="w"> </span><span class="n">blobRetriever</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="n">AnnouncementWatcher</span><span class="w"> </span><span class="n">announcementWatcher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="n">HollowProducer</span><span class="w"> </span><span class="n">producer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">HollowProducer</span><span class="p">.</span><span class="na">withPublisher</span><span class="p">(</span><span class="n">publisher</span><span class="p">)</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">                                        </span><span class="p">.</span><span class="na">withAnnouncer</span><span class="p">(</span><span class="n">announcer</span><span class="p">)</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">                                        </span><span class="p">.</span><span class="na">build</span><span class="p">();</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="n">producer</span><span class="p">.</span><span class="na">initializeDataModel</span><span class="p">(</span><span class="n">Movie</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
</span><span id="__span-19-11"><a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a>
</span><span id="__span-19-12"><a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="kt">long</span><span class="w"> </span><span class="n">latestAnnouncedVersion</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">announcementWatcher</span><span class="p">.</span><span class="na">getLatestVersion</span><span class="p">();</span>
</span><span id="__span-19-13"><a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="n">producer</span><span class="p">.</span><span class="na">restore</span><span class="p">(</span><span class="n">latestAnnouncedVersion</span><span class="p">,</span><span class="w"> </span><span class="n">blobRetriever</span><span class="p">);</span>
</span><span id="__span-19-14"><a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a>
</span><span id="__span-19-15"><a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a><span class="n">producer</span><span class="p">.</span><span class="na">runCycle</span><span class="p">(</span><span class="n">state</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-16"><a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">   </span><span class="p">...</span>
</span><span id="__span-19-17"><a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="p">});</span>
</span></code></pre></div>
<p>In the above code, we first <em>initialize</em> the data model by providing the set of classes we will add during the cycle.<br />
After that, we <em>restore</em> by providing our <code>BlobRetriever</code> implementation, along with the version which should be 
restored.  The <code>HollowProducer</code> will use the <code>BlobRetriever</code> to load the desired state, then use it to <em>restore</em> itself.<br />
In this way, a delta can be produced at startup, and consumers will not have to load a snapshot to get up-to-date.</p>
<div class="admonition hint">
<p class="admonition-title">Initializing the data model</p>
<p>Before <em>restoring</em>, we must always <em>initialize</em> our data model.  When a data model changes between deployments, 
Hollow will automatically merge records of types which have changed.  In order to do this correctly, Hollow needs to 
know about the current data model before the restore operation begins.</p>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Netflix/hollow" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://gitter.im/Netflix/hollow" target="_blank" rel="noopener" title="gitter.im" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M66.4 322.5H16V0h50.4v322.5zM166.9 76.1h-50.4V512h50.4V76.1zm100.6 0h-50.4V512h50.4V76.1zM368 76h-50.4v247H368V76z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "content.code.copy", "navigation.indexes", "navigation.instant", "navigation.top", "navigation.tracking", "search.share", "search.highlight", "search.suggest"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.51198bba.min.js"></script>
      
    
  </body>
</html>